(window.webpackJsonp=window.webpackJsonp||[]).push([["infogram-charts/charts-area~infogram-charts/charts-area_stacked~infogram-charts/charts-area_stacked_~cd98196a"],{"/6f4":function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return r});var n=a("JPcv"),i=a("ZBKM");function r(e){if(e.get("isFreelayoutInline")){var t=Object(n.fromJS)(e.attributes);t=t.withMutations(function(e){if(e.delete("chart_id"),e.delete("isFreelayoutInline"),e.delete("template"),e.delete("dataSets"),e.delete("interlinkedCharts"),e.delete("tabs"),e.deleteIn(["custom","height"]),e.deleteIn(["custom","viewMode"]),e.deleteIn(["custom","map_json"]),e.deleteIn(["custom","yminraw"]),e.deleteIn(["custom","ymaxraw"]),e.deleteIn(["custom","xminraw"]),e.deleteIn(["custom","xmaxraw"]),e.deleteIn(["custom","y2minraw"]),e.deleteIn(["custom","y2maxraw"]),e.deleteIn(["custom","pointSizeminraw"]),e.deleteIn(["custom","pointSizemaxraw"]),e.deleteIn(["custom","dataPointRadiusRangemaxraw"]),e.deleteIn(["custom","dataPointRadiusRangeminraw"]),e.get("sheets_settings"))for(var t=0;t<e.get("sheets_settings").size;t++){e.getIn(["sheets_settings",t])&&(e.deleteIn(["sheets_settings",t,"yminraw"]),e.deleteIn(["sheets_settings",t,"ymaxraw"]),e.deleteIn(["sheets_settings",t,"xminraw"]),e.deleteIn(["sheets_settings",t,"xmaxraw"]),e.deleteIn(["sheets_settings",t,"y2minraw"]),e.deleteIn(["sheets_settings",t,"y2maxraw"]),e.deleteIn(["sheets_settings",t,"pointSizeminraw"]),e.deleteIn(["sheets_settings",t,"pointSizemaxraw"]),e.deleteIn(["sheets_settings",t,"dataPointRadiusRangemaxraw"]),e.deleteIn(["sheets_settings",t,"dataPointRadiusRangeminraw"]))}}),Object(i.default)(e.get("chart_id"),t,e)}}},"0Qba":function(e,t,a){"use strict";a.r(t),function(e){var n=a("LvDl"),i=a.n(n),r={load:function(t,a){var n=t.split(","),s=r.shapes;if(window.inlineShapes&&i.a.each(n,function(e){var t="".concat(e,"Path");window.inlineShapes[t]&&(s[t]=window.inlineShapes[t])}),(t=n.filter(function(e){if(!s["".concat(e,"Path")])return e})).length){if(window.app.crm)return e.get("/api/shapes/342,454",i.a.bind(function(e){e&&i.a.each(e,function(e){var t="".concat(e.title,"Path");s[t]={dimensions:e.dimensions,searchkey:e.searchkey,path:e.path,title:t}})},this),"json").then(a);var o=e.get("/api/shapes/".concat(i.a.uniq(t).join(",")),i.a.bind(function(e){e&&i.a.each(e,function(e){var t="".concat(e.title,"Path");s[t]={dimensions:e.dimensions,searchkey:e.searchkey||e.title,path:e.path,title:t}})},this),"json");return o.then(a),o}a()},shapes:{},getShapes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=t.toLowerCase();var n=r.shapes,s=a?{}:[];return Object.keys(n).forEach(function(r){var o=n[r],c=!0;if(t&&-1===o.searchkey.toLowerCase().indexOf(t)?c=!1:e&&o.usergroup!==e&&(c=!1),i.a.get(o,"dimensions.width")){var l=Math.max((32-o.dimensions.width)/2,0),u=Math.max((32-o.dimensions.height)/2,0),h={transform:"translate(".concat(l," ").concat(u,")")};o=i.a.extend(o,h)}c&&(a?s[r]=o:s.push(o))}),s}};t.default=r}.call(this,a("+hRF"))},"474q":function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return s});var n=a("LvDl"),i=a.n(n),r=a("Z8Pq");function s(e){var t=e.options,a=e.emptySheet,n=e.createNumberParser,s=Object(r.createExtractCell)(t);function o(s,o){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=i.a.merge({},a),u=i.a.merge({},l.series[0]),h=c?s.map(function(e){return e[0]}):s[0]||[],f=t.sheetnames&&t.sheetnames[o],d=n.call(e,o+1);l.series=[],l.categories.data=[],l.categories.title=Object(r.replaceBlank)(f||h[0]);var p=function(e,t){var a=[];return function(n){var r,s=a.indexOf(n);if(-1===s){var o=a.length;a.push(n),r=function(e){return e.data=e.data||[],e.rawData=e.rawData||[],e.links=e.links||[],e}(i.a.merge({},t,{title:n,type:"line-area",index:o})),e.series.push(r)}else r=e.series[s];return r}}(l,u),g=Object(r.categoryHelper)(l);return t.sheets.push(l),function(e,t,a,n){return function(i){var s=i.row,o=i.link,c=s[0],l=s[1],u=s[2],h=s[3],f=Object(r.replaceBlank)(s[4]),d=e(f),p=t(c),g=[Number(a(l)),Number(a(u)),Number(a(h))],m=[l,u,h];d.data[p]=g,d.rawData[p]=m,d.dataLabels=[n[1],n[2],n[3]],d.links.push(o)}}(p,g,d,h)}return{default:Object(r.createImportFn)(function(e,t){var a=o(e,t);e.forEach(function(e,t){0!==t&&a(Object(r.getRowValuesAndLink)(e,s))})}),transposed:Object(r.createImportFn)(function(e,t){for(var a=o(e,t,!0),n=Object(r.getMaxColCount)(e),c=[],l=1;l<n;l++){for(var u=[],h=0;h<5;h++){var f=i.a.get(e,"[".concat(h,"][").concat(l,"]"));u.push(f)}c.push(u)}c.forEach(function(e){a(Object(r.getRowValuesAndLink)(e,s))})})}}},"6LTm":function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n),r=a("xEkU"),s=a.n(r),o=a("30U6"),c=a("h7h9");function l(e,t,a,n,i,r,s){try{var o=e[r](s),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}var u,h,f=Object(o.dispatch)("interlinkedTab"),d=!1,p=!1;function g(e){Object.keys(c.default.getAllEntities()).forEach(function(t){var a=c.default.getEntity(t);a&&e(a)})}function m(e,t){return e.options.sheets.map(function(e){return e.categories.title.trim()}).indexOf(t&&t.trim())}var v={get sheetName(){return u},set sheetName(e){u=e},reset:function(e){f=Object(o.dispatch)("interlinkedTab"),u=void 0,d=!!e,this.unsubscribeAll()},updateSheetIndex:function(e){var t=m(e,u);-1!==t&&(e.sheetIndex=t)},subscribe:function(e){var t=i.a.get(e,"instance");t&&d&&(this.updateSheetIndex(t),f.on("interlinkedTab.".concat(e.id),function(){var n,i=(n=regeneratorRuntime.mark(function n(i,r){var s,o,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(c.default.getEntity(e.id)){n.next=4;break}return v.unsubscribe(e),n.abrupt("return");case 4:if(t!==r){n.next=6;break}return n.abrupt("return");case 6:if(-1===(s=m(t,i))){n.next=15;break}return n.next=10,Promise.all([a.e("infogram-charts/dep-10"),a.e("infogram-charts/dep-12")]).then(a.bind(null,"rxf+"));case 10:o=n.sent,l=o.addRenderQueue,t.previousIndex=t.sheetIndex,t.sheetIndex=s,l(t);case 15:case"end":return n.stop()}},n)}),function(){var e=this,t=arguments;return new Promise(function(a,i){var r=n.apply(e,t);function s(e){l(r,a,i,s,o,"next",e)}function o(e){l(r,a,i,s,o,"throw",e)}s(void 0)})});return function(e,t){return i.apply(this,arguments)}}()),t.events.on("tabChanged",function(e){u=i.a.get(e,"name"),h=[u,t],p||d&&s()(function(){(function e(t,a){h=void 0,p=!0,f.call("interlinkedTab",null,t,a),p=!1,void 0!==h&&t!==h[0]&&e.apply(null,h)}).apply(null,h)})}))},unsubscribe:function(e){f.on("interlinkedTab.".concat(e.id),null);var t=i.a.get(e,"instance.events");t&&t.on("tabChanged",null)},unsubscribeAll:function(){var e=this;g(function(t){e.unsubscribe(t)})},toggle:function(e){var t=this;u=void 0,(d=!!e)?g(function(e){t.subscribe(e)}):this.unsubscribeAll()}};t.default=v},"6jAQ":function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"getChartType",function(){return S});var n=a("LvDl"),i=a.n(n),r=a("SC+/"),s=a("rxf+"),o=a("wrGL"),c=a("ibon"),l=a("JnWj"),u=a("pLmG"),h=a("0Qba"),f=a("/6f4"),d=a("6LTm"),p=a("tcv8"),g=a("S99L"),m=a("Oq5T"),v=a("wUcv"),E=a("SdvQ"),b=a("h7h9"),O=a("pWQL");function _(e,t,a,n,i,r,s){try{var o=e[r](s),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(t){e("#Chart_"+t).empty(),Object(b.removeEntity)(t)}function S(e){return(e.getChartInstance()||e).chart.getTypeMod()}function y(e,t){var a=t.decimalSeparator,n=t.groupingSymbol,r=t.decimalPlaces,s=t.decimalPlacesValue;n&&i.a.set(e,"grouping","none"===n?"":n);var o=!1===a;i.a.set(e,"decimal",o?".,":a),i.a.set(e,"numberParser",new l.default(o?"legacy":"firstNumber",a)),r&&void 0!==s&&i.a.set(e,"decimalPlaces",s)}var A=[".,",".",","],x=[O.PICTORIAL_GRID,O.PICTORIAL_SIZE,O.MAP,O.TABLE,O.PICTORIAL_BAR,O.FACTS_AND_FIGURES],C=[O.MAP,O.TABLE,O.FACTS_AND_FIGURES],k=["edit","capture","download"];function N(e){switch(e){case O.PICTORIAL_GRID:case O.PICTORIAL_SIZE:case O.GAUGE:return 250;case O.PICTORIAL_BAR:case O.TIMER:case O.BAR_PROGRESS:return 70;default:return 400}}t.default={instanceClass:null,defaultHeight:400,defaultCategoryHeight:40,defaultCategoryWidth:40,defaultShape:"boyPath",initialize:function(e){var t=this;return this.initVariables(e),this.loadingShapes&&this.cleanup(),this.loadShapes().then(function(){return t.setupChartOptions(),t.setupChartOptionsStyle(),t.setupChartOptionsCustomStyle(),t.createInstance()})},loadShapes:function(){var t=this,a=e.Deferred(),n=this.custom,r=this.chart.getTypeMod(),s=[];if(-1!==x.indexOf(r)){if(r===O.FACTS_AND_FIGURES){var o=/^[a-zA-Z0-9-_]+$/;this.chart.get("data").forEach(function(e){e.forEach(function(e){if(e&&e[2]){var t="string"==typeof e[2]?e[2]:"";i.a.has(e,"[2].value")&&(t=e[2].value);var a=t.trim();(function(e){return o.lastIndex=0,!(!e||e.length>64)&&o.test(e)})(a)&&s.push(a)}})})}else{var c="defaultPath";switch(r){case O.PICTORIAL_SIZE:n[c]=n[c]||"circlePath";break;case O.MAP:n[c="path"]=n[c]||"circlePath";break;case O.TABLE:n[c]=n[c]||"circlePath";break;case O.PICTORIAL_BAR:c="path"}s=[i.a.has(n,c)&&n[c]||"boy"],n.shapes&&(s=s.concat(n.shapes)),this.sheetSettings&&this.sheetSettings.forEach(function(e){e&&e[c]&&s.push(e[c]),e&&e.shapes&&(s=s.concat(e.shapes))})}if(r===O.TABLE)this.chart.get("data").forEach(function(e){e.forEach(function(e){e.forEach(function(e){(e=Object(m.default)(e)).shape&&s.push(e.shape)})})});var l=i.a.map(s,function(e){return e.replace("Path","")});this.loadingShapes=h.default.load(l.join(","),function(){a.resolve(),t.loadingShapes=void 0})}else a.resolve();return a},cancelRender:function(){this.delayedRender&&("embed"===this.viewMode||"web"===this.viewMode?cancelAnimationFrame(this.delayedRender):clearTimeout(this.delayedRender),this.delayedRender=null)},initVariables:function(e){var t=e.chart,a=e.theme,n=e.id,r=e.sheetIndex,s=e.data,o=e.tabs,c=e.sheetPlayer,l=e.freeLayout,u=e.disableColumnSheets,h=e.interactivityHintEnabled,f=e.editable,d=e.viewMode,p=e.downloadMode,g=e.scale,m=e.observer,v=e.animate,E=void 0===v||v;this.chart=t,this.theme=a,this.id=n||t.get("chart_id"),this.sheetIndex=r,this.initializeData(s||t.get("data")),this.custom=t.get("custom"),this.colors=t.get("colors"),this.sheetSettings=t.get("sheets_settings"),this.themeColors=a.get("colors")||[],this.themeFont=a.get("font")||{},this.themeStyleColor=a.get("color")||{},this.charts=a.get("charts"),this.displayTabs=!!o,this.sheetPlayer=c,this.freeLayout=!!l,this.disableColumnSheets=!!u,this.interactivityHintEnabled=h,this.observer=m,this.editable=f,this.viewMode=d,this.downloadMode=p,this.scale=g,this.animate=!0===E&&i.a.get(this.custom,"animation.enabled",!0),t.view&&t.view.infographic&&(this.infographic=t.view.infographic),0===this.colors.length&&t.getTypeMod()!==O.TABLE&&(this.colors=this.themeColors.slice(0))},initializeData:function(e){e.forEach(function(t,a){t&&t.length||(t=e[a]=[[]]),i.a.isArray(t[0])||(t[0]=[])}),this.data=e},setupChartOptions:function(){var t=this.animate,a=this.chart,n=this.charts,r=this.custom,s=this.displayTabs,o=this.downloadMode,c=this.id,l=this.instanceClass,h=this.sheetPlayer,f=this.freeLayout,d=this.editable,p=this.chartOptions=l.prototype.defaults();r.viewMode=a.view?a.view.parent.viewMode:o?"capture":"freeLayout",p.sheetnames=a.get("sheetnames"),p.sheetOptions=this.setupChartSheetOptions(),p.container="#Chart_".concat(c),p.fixedHeight=f,p.editable=d,p.scale={x:i.a.get(this,"scale.x",1),y:i.a.get(this,"scale.y",1)},this.setupChartOptionsDimensions(),i.a.set(p,"tooltip.enabled",i.a.get(r,"tooltip.enabled",!0));var g=(i.a.get(r,"showSheetPlayer")?"player":s&&"tab")||"radio";i.a.set(p,"sheetSwitch.enabled",!0),i.a.set(p,"sheetSwitch.type",g),i.a.merge(p.sheetSwitch.tabOptions,i.a.get(n,"sheetSwitch.tabOptions",{})),h&&(p.sheetPlayer=h),i.a.has(r,"shrink")&&r.shrink>0&&(p.width=u.default.chartWidth(r.shrink),e(p.container).css("width",p.width)),p.downloadText=i.a.get(r,"showDownload")&&(i18n.t("table.download_data")||"Download data"),t||i.a.set(p,"animation.duration",0)},setupChartSheetOptions:function(){var e=this.sheetSettings,t=this.custom;t&&i.a.has(t,"colors")&&delete t.colors;var a=i.a.omit(t,"map_json"),n=e&&e.length,r=[this.setupChartSheetOptionsItem(i.a.merge({},a))];if(n)for(var s=0;s<n;s++){var o=i.a.merge({},a,e[s]);r.push(this.setupChartSheetOptionsItem(o,s))}return r},sheetOptionsItemDefaults:function(e){var t=this.getGridSettings(e),a=t.vertical,n=t.horizontal,r=this.getZeroBaseline(e),s=r.verticalZero,o=r.horizontalZero,c={categories:{colors:i.a.merge([],this.themeColors,e.colors||this.colors)},series:[{}],grid:{vertical:a,horizontal:n,verticalZero:s,horizontalZero:o},axis:[{},{}]};return this.setupLegend(c,e),c},setupChartSheetOptionsItem:function(e){return{categories:{colors:i.a.merge([],this.themeColors,e.colors||this.colors)},grid:{},axis:[{}]}},setupLegend:function(e,t){e.legend={enabled:!1!==t.showLabels,position:i.a.get(t,"labels.legend.position",i.a.get(this,"charts.legend.position","bottom")),align:i.a.get(t,"labels.legend.align",i.a.get(this,"charts.legend.align","top")),layouts:i.a.get(this,"charts.legend.layouts",{})}},addPx:function(e){return e+(/px/.test(e)?"":"px")},getGridSettings:function(e){var t=i.a.get(e,"axis.x.grid"),a=i.a.get(e,"axis.y.grid");if(void 0===t&&void 0===a){var n=!1!==e.grid;t=n,a=n}return{vertical:t,horizontal:a}},getGridSettingsHorizontal:function(e){var t=i.a.get(e,"axis.y.grid");return void 0===t&&!1===e.grid&&(t=!1),t},getGridSettingsVertical:function(e){var t=i.a.get(e,"axis.x.grid");return void 0===t&&!1===e.grid&&(t=!1),t},getZeroBaseline:function(e){return{verticalZero:this.getZeroBaselineVertical(e),horizontalZero:this.getZeroBaselineHorizontal(e)}},getZeroBaselineVertical:function(e){return i.a.get(e,"axis.x.zeroBaseline",!0)},getZeroBaselineHorizontal:function(e){return i.a.get(e,"axis.y.zeroBaseline",!0)},assignAxisInverse:function(e,t,a){var n=["y","y2"].indexOf(a)+1;i.a.set(e,"axis[".concat(n,"].invert"),i.a.get(t,"axis.".concat(a,".invert"),!1))},assignTrendline:function(e,t){var a=i.a.merge({text:this.themeStyleColor.text},this.themeStyleColor.chart||{}),n=i.a.get(a,"text","#464646");i.a.set(e,"categories.trendline.enabled",i.a.get(t,"trendline.enabled",!1)),i.a.set(e,"categories.trendline.color",i.a.get(t,"trendline.color",n))},setupChartOptionsStyle:function(){var e=this,t=i.a.get(this,"custom.textColor"),a=this.chartOptions,n=i.a.merge({},this.themeFont.common||{},this.themeFont.label||{}),s=i.a.merge({},this.themeFont.common||{},this.themeFont.legend||{}),c=i.a.merge({text:this.themeStyleColor.text},this.themeStyleColor.chart||{});t&&(c.text=t),a.style.grid.color=Object(o.gridColor)(this.custom,{charts:this.charts,color:this.themeStyleColor}),a.style.grid.opacity=i.a.get(this,"custom.axis.alpha",i.a.get(this,"charts.grid.alpha",.5)),i.a.set(a,"style.graph.item.outline.color",t||c.text),i.a.set(a,"style.graph.item.outline.width","1px"),["x","y","y2"].forEach(function(t){a.style.axis[t].tick["font-family"]=n.fontFamily,a.style.axis[t].tick["font-size"]=e.addPx(n.fontSize),a.style.axis[t].tick["font-weight"]=n.fontWeight,a.style.axis[t].tick["font-style"]=n.fontStyle,a.style.axis[t].tick.color=c.text,a.style.axis[t].title["font-family"]=n.fontFamily,a.style.axis[t].title.color=c.text}),["name","value"].forEach(function(t){a.style.graph.item[t]["font-family"]=n.fontFamily,a.style.graph.item[t]["font-size"]=e.addPx(n.fontSize),a.style.graph.item[t]["font-weight"]=n.fontWeight,a.style.graph.item[t]["font-style"]=n.fontStyle,"name"===t&&(a.style.graph.item[t].color=c.text)}),i.a.has(a.style,"graph.item.value.color.contrast")&&i.a.set(a.style,"graph.item.value.color.contrast.background",this.getChartBackgroundColor()),i.a.merge(a.style.sheetSwitch,i.a.get(this,"charts.sheetSwitch.style",{})),a.style.sheetSwitch.tab["font-family"]=i.a.get(this,"charts.sheetSwitch.style.tab.font-family",n.fontFamily),a.style.sheetSwitch.radio["font-family"]=n.fontFamily;var l={};l.text=i.a.pick(a.style.sheetSwitch.tab,["font-family","font-size","font-weight"]);var u=i.a.get(this,"charts.sheetSwitch.style.tab.colors.tab.background");u&&i.a.set(l,"colors.background",u);var h=i.a.get(this,"charts.sheetSwitch.style.tab.color");if(h&&i.a.set(l,"colors.foreground",h),t){var f=a.style.sheetSwitch.tab;f.color=t,f.colors.dropdown.selectIcon=t,f.colors.dropdown.leftSwitcherIcon=t,f.colors.dropdown.rightSwitcherIcon=t}i.a.merge(a.style.hint,l),a.style.legend["font-family"]=s.fontFamily,a.style.legend["font-size"]=this.addPx(s.fontSize),a.style.legend["font-weight"]=s.fontWeight,a.style.legend["font-style"]=s.fontStyle,i.a.merge(a.style.legend.color,i.a.get(this,"charts.legend.color",{}));var d=i.a.get(this,"custom.labels.legend.color");if(!d&&t&&(d=t),d){var p=Object(r.rgb)(d);p.opacity=.7,a.style.legend.color.label={active:d,hover:p.toString(),inactive:d}}},setupChartOptionsCustomStyle:function(){this.assignChartOptionsCustomStyle(["axis.x.tick","axis.y.tick","axis.y2.tick","axis.x.title","axis.y.title","axis.y2.title","graph.item.name","graph.item.value","legend","sheetSwitch.tab","tooltip.text","tooltip.value","regionNames"])},assignChartOptionsCustomStyle:function(e){var t=this.chart,a=this.custom,n=this.chartOptions,r=Object(o.defaultColorMethod)(t),s=["font-size","font-style","font-weight","color"],c=this.getChartBackgroundColor(),l=t.getTypeMod(),u=[O.PICTORIAL_SIZE,O.PICTORIAL_BAR];e.forEach(function(e){i.a.get(a,"labels.".concat(e))&&s.forEach(function(t){var s=i.a.get(a,"labels.".concat(e,".").concat(t));if("graph.item.value"===e&&"color"===t&&(!s||"string"==typeof s)){if(-1!==u.indexOf(l))return;return O.TREEMAP===l?void(s&&"string"==typeof s&&i.a.set(n.style,"".concat(e,".").concat(t),s)):void i.a.set(n.style,"".concat(e,".").concat(t),i.a.merge({contrast:{background:c}},Object(o.defaultColorValue)(s,r)))}if(s&&("legend"!==e||"color"!==t)){var h="color"===t&&"graph.item.value"===e&&"object"===T(s)?i.a.merge({contrast:{background:c}},s):i.a.cloneDeep(s);i.a.set(n.style,"".concat(e,".").concat(t),h)}})})},setupChartOptionsDimensions:function(){var e=this.custom,t=this.chartOptions;i.a.get(e,"height")?t.height=parseInt(e.height,10):t.height=this.defaultHeight},getChartBackgroundColor:function(){var e=i.a.get(this.themeStyleColor,"chart.bg","transparent");return"transparent"===e&&"transparent"===(e=i.a.get(this.themeStyleColor,"bg","transparent"))&&(e="#ffffff"),e},createInstance:function(){var t,a=(t=regeneratorRuntime.mark(function t(){var a,n,r,o,l,u=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return l=function(){a?(delete o.legendData,o.render()):Object(s.addRenderQueue)(o)},a=!1,n=this.chartOptions,this.cleanup(),r=this.getChartInstance(),this.chartOptions.height||(this.chartOptions.height=N(this.chart.getTypeMod())),(o=i.a.get(r,"instance"))?(a=!0,this.instance=o,o.mergeOptions(n)):(o=new this.instanceClass(n),this.instance=o),i.a.has(this.custom,"defaultTab")&&(o.sheetIndex=this.custom.defaultTab),c.default.create({chartType:S(this),chart:o,decimalSeparator:this.getDecimalSeparator(),transpose:this.transposeImport(),useAllColumns:this.custom.useAllColumns,disableColumnSheets:this.disableColumnSheets,editable:this.editable}).import(this.data),o.applySheetOptions(o.options.sheetOptions),d.default.subscribe(this),void 0!==this.sheetIndex&&(o.sheetIndex=this.sheetIndex,i.a.set(o,"options.sheetSwitch.enabled",!1)),o.loaded=e.Deferred(),o.events.on("endAnimation",function(){o.loaded.resolve(),o.events.on("endAnimation",null),u.observer&&u.interactivityHintEnabled&&-1===k.indexOf(u.viewMode)&&u.observer.add(o.root.node(),function(e){u.observer.getSmallerObjectVisibilityRatio(e)>.5?u.scheduleInteractivityHint(o):u.cancelInteractivityHint()})}),o.events.on("downloadData",function(){var e=o.sheetIndex,t=u.chart.get("data"),a=t[e]?e:0,n={data:t[a],title:u.chart.get("sheetnames")[a]||"data",firstCellContainsData:C.includes(u.chart.getTypeMod())};g.default.downloadData(n)}),this.chart.getTypeMod()===O.MAP&&o.events.on("storePosition",function(){var e=o.map;e.resetZoom&&e.positionChanges&&delete e.resetZoom;var t=e.applyToAllSheets,a=[];if(t)for(var n=0,r=o.options.sheets.length;n<r;n++)a.push(n);else a.push(o.sheetIndex);var s=e.getBounds(),c={view:{bounds:[[s.getNorthWest().lat,s.getNorthWest().lng],[s.getSouthEast().lat,s.getSouthEast().lng]]}};e.resetZoom&&(c.view=null,delete e.resetZoom);var l=u.chart;(a.forEach(function(e){(o.options.sheetOptions[e]=i.a.merge({},o.options.sheetOptions[e],{view:c.view}),o.options.sheets[e]=i.a.merge({},o.options.sheets[e],{view:c.view}),Object(p.default)({chart:l,sheetIndex:e}).setCustom(c),t)||Object(v.buildXHR)({sheetIndex:e,chart:l}).setCustom(c).send()}),t)&&Object(v.buildXHR)({chart:l,applyToAllSheets:"view"}).setCustom(c).send();Object(f.default)(l)}),o.events.on("interaction",function(e){!u.freeLayout&&"link"===e.location&&"click"===e.type&&i.a.get(e,"params.value")&&(window.open(e.params.value).opener=null);var t=u.id;"number"==typeof u.id&&(t="c_".concat(u.id)),Object(E.engagementEvent)(t,e.location,e.type),u.interactedWith=!0}),"embed"===this.viewMode||"web"===this.viewMode?this.delayedRender=requestAnimationFrame(l):this.delayedRender=i.a.delay(l,this.delayVisualInitialization),t.abrupt("return",this);case 20:case"end":return t.stop()}},t,this)}),function(){var e=this,a=arguments;return new Promise(function(n,i){var r=t.apply(e,a);function s(e){_(r,n,i,s,o,"next",e)}function o(e){_(r,n,i,s,o,"throw",e)}s(void 0)})});return function(){return a.apply(this,arguments)}}(),resize:function(e,t){var a=this.instance;a.options.width=e,t&&(a.options.height=t),Object(s.addRenderQueue)(a)},getDecimalSeparator:function(){var e=-1!==A.indexOf(this.custom.decimalSeparator),t=A[0],a=[];e&&(t=this.custom.decimalSeparator);var n=this.infographic&&this.infographic.get("properties")&&this.infographic.get("properties").decimal_separator;return!e&&n&&(t=n),i.a.has(this,"custom.dataInputFormat.decimalSeparator")&&(t=i.a.get(this,"custom.dataInputFormat.decimalSeparator")),a.push(t),this.sheetSettings&&(a=a.concat(this.sheetSettings.map(function(e){return e&&e.decimalSeparator||null}))),a},transposeImport:function(){return this.custom.switchRowsColumns},updateData:function(e){var t=this.instance;t&&(c.default.create({chartType:S(this),chart:t,decimalSeparator:this.getDecimalSeparator(),transpose:this.transposeImport()}).import(e),t.applySheetOptions(t.options.sheetOptions),t.render())},assignCategoryLabelLayout:function(e,t){"tilted"===t.categoryLayout&&(e.layout="tilted")},assignNumberFormatValues:function(e){var t=this,a=e.sheetOptions,n=e.custom,r=e.axis,s={x:0,y:1,y2:2};r.forEach(function(e){var r=e.id,o=e.path,c=o?i.a.get(n,o,{}):n,u=a.axis[s[r]];i.a.has(u,"format")||i.a.set(u,"format",{});var h=u.format;if(y(h,c),i.a.has(t,"custom.dataInputFormat.decimalSeparator")){var f=i.a.get(t,"custom.dataInputFormat.decimalSeparator");i.a.set(h,"numberParser",new l.default("firstNumber",f))}var d=["useSIPrefixes"];i.a.get(n,"axis.".concat(r,".affix"),!0)&&d.push("prefix","suffix"),d.forEach(function(e){var t=i.a.get(c,e);void 0!==t&&i.a.set(h,e,t)})})},assignNumberFormatLabels:function(e){var t=this,a=e.sheetOptions,n=e.custom,r=e.affixes,s={label:{libraryTargetPath:"labels.format",customAffixPath:"labels.graph.item.format.affix"},x:{libraryTargetPath:"tooltip.format.x",customAffixPath:"labels.tooltip.format.x.affix"},y:{libraryTargetPath:"tooltip.format.y",customAffixPath:"labels.tooltip.format.y.affix"},y2:{libraryTargetPath:"tooltip.format.y2",customAffixPath:"labels.tooltip.format.y2.affix"}};(void 0===r?[]:r).forEach(function(e){var r=e.id,o=e.path,c=e.ignoreCheck,u=e.defaultValue,h=s[r],f=h.libraryTargetPath,d=h.customAffixPath,p=o?i.a.get(n,o,{}):n,g=i.a.pick(p,"prefix","suffix");if(y(g,p),i.a.has(t,"custom.dataInputFormat.decimalSeparator")){var m=i.a.get(t,"custom.dataInputFormat.decimalSeparator");i.a.set(g,"numberParser",new l.default("firstNumber",m))}c||i.a.get(n,d,u)||(i.a.unset(g,"prefix"),i.a.unset(g,"suffix")),i.a.set(a,f,g)})},assignAxisTicks:function(e,t){var a=e.axis,n=["x","y","y2"];a.forEach(function(e,a){e.ticks=i.a.get(t,"labels.axis.".concat(n[a],".tick.enabled"),!0)})},assignAxisTickInterval:function(e,t){var a=e.axis,n=["x","y","y2"];a.forEach(function(e,a){var r=i.a.get(t,"axis.".concat(n[a],".ticks"));void 0!==r&&(e.tickInterval=r)})},reinitialize:function(){var t=this.instance;t&&(e(this.chartOptions.container+" .igc-root").empty(),t.render())},scheduleInteractivityHint:function(e){var t=this;this.interactedWith||this.interactivityHintDelay||(this.interactivityHintDelay=setTimeout(function(){t.interactedWith||(e.interactionHint(),t.interactedWith=!0,t.interactivityHintDelay=null)},3e3))},cancelInteractivityHint:function(){this.interactivityHintDelay&&(clearTimeout(this.interactivityHintDelay),this.interactivityHintDelay=null)},getChartInstance:function(){return b.default.getEntity(this.id)},cleanup:function(){var e,t=this.id,a=this.getChartInstance();a&&(e=a.instance),this.loadingShapes&&(this.loadingShapes.abort(),this.loadingShapes=void 0),e&&(this.observer&&this.observer.remove(e.container.node()),this.cleanUpSheetPlayer(),this.instanceClass.getClassName()!==e.getClassName()&&I(t))},remove:function(){var e,t=this.id,a=this.getChartInstance();a&&(e=a.instance),e&&(this.cleanUpSheetPlayer(),I(t))},cleanUpSheetPlayer:function(){var e=this.getChartInstance(),t=i.a.get(e,"instance.sheetPlayer");t&&i.a.get(e,"instance.sheetPlayerNode")&&t.remove()}}}.call(this,a("+hRF"))},JnWj:function(e,t,a){"use strict";a.r(t);var n={firstNumber:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",a=1;function n(e){return e<0?"-":""}if("string"==typeof(e=i(e))){var r=[],s=e.search(/\d/),o=s-1,c=e.indexOf(t);if(-1===c&&(c=e.length),c<s){if(e[o]===t){var l=e.slice(o,e.length).split(/(\d+)/);return l[0]===t&&l[1]&&r.push("0.".concat(l[1])),"-"===e[c-1]&&(a=-1),"".concat(n(a)).concat(i(r.join("")))}c=e.length}"-"===e[o]&&(a=-1);for(var u,h=e.slice(s,c),f=1,d=/^[\\., ]$/,p=h.split(/(\d+)/),g=p.length;f<g;f++){var m=p[f];if(/\d/.test(m))if(1===f){if(r.push(m),m.length>3)break}else{if(3!==m.length)break;r.push(m)}else{if(!d.test(m))break;if(u||(u=m),u!==m)break}}if(r.join(" ").length===h.length){var v=e.slice(c,e.length).split(/(\d+)/);v[0]===t&&v[1]&&r.push("."+v[1])}e=i(r.join(""))}return"".concat(n(a)).concat(e)},legacy:function(e){var t="";return"string"==typeof e&&(t="-"===e[0]?e[0]:"",-1!==e.indexOf(",")&&(e=e.replace(/,/g,".")),e=(e=e.replace(/\.(?![^.]+$)/g,"")).replace(/[^0-9\.]/g,"")),""===e?"undefined":"".concat(t).concat(i(e))}};function i(e){if(""!==e)return e}t.default=function(e,t){return t=","===t?",":".",function(e,t){return function(a){return e(a,t)}}(n[e]||n.firstNumber,t)}},LU9w:function(e,t,a){"use strict";a.r(t),a.d(t,"ENGAGEMENT_EVENT",function(){return n}),a.d(t,"ENGAGEMENT_INSCREEN",function(){return i});var n="ENGAGEMENT_EVENT",i="ENGAGEMENT_INSCREEN"},Oq5T:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return h});var n=a("LvDl"),i=a.n(n);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=/\[img\=((https?:)?\/\/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)\]/g,o=/\[svg\=([^]*)\]/g,c=/\[([^\]]*)\]\((https?:\/\/[^\)]*)\)/gi,l=["background-color","color","font-size","font-style","font-weight","text-align","text-decoration","vertical-align"],u=function(e){if("link"===e.type){var t=function(e){return-1===e.indexOf("mailto:")?"_blank":"_self"}(e.href),a=i.a.escape(e.href),n=(e.value||"").replace(/\</g,"&lt;");return{href:a,value:n,target:t,text:n.toLowerCase()}}if(e.value||""===e.value){var r=e.value.toString().replace(/\</g,"&lt;");return{text:r.toLowerCase(),value:r}}for(var s,o=e=e.toString().replace(/\</g,"&lt;");null!==(s=c.exec(e));)s&&s[1]&&s[2]&&(e=e.replace(s[0],"<a href='".concat(s[2],"' target='_blank'>").concat(s[1],"</a>")),o=o.replace(s[0],s[1]));return c.lastIndex=0,{text:o.toLowerCase(),value:e}};function h(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={value:"",className:t};if(null==e)return n;"object"===r(e)&&Object.keys(e).forEach(function(t){-1!==l.indexOf(t)&&(n[t]=e[t])});var c=e.value||e;""!==c&&a&&"igc-table-header"!==t&&(n.shape=a,n.tooltip=c),s.lastIndex=0;var h=s.exec(c);if(h)n.img=h[1];else{o.lastIndex=0;var f=o.exec(c);f&&(n.shape=f[1])}return i.a.merge(n,u(e))}},PZzD:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return o});var n=a("LvDl"),i=a.n(n),r=a("Z8Pq");function s(e,t){return i.a.get(e,"sheetOptions[".concat(t,"].series[0].parseFormat.x"))}function o(e){var t=e.options,a=e.emptySheet,n=Object(r.createExtractCell)(t);return{default:Object(r.createImportFn)(function(o,c){var l=i.a.merge({},a),u=o[0]||[],h=t.sheetnames&&t.sheetnames[c],f=function(e){return e};"number"===(s(t,c+1)||s(t,0))&&(f=e.createNumberParser(c+1));var d=i.a.merge({},l.series[0]);l.series=[d],d.data=[],d.rawData=[],d.links=[],l.categories.data||(l.categories.data=[]),l.categories.title=Object(r.replaceBlank)(h||u[0]),o.forEach(function(e,t){if(0!==t){var a,i=[];e.forEach(function(e){var t=n(e);t.link&&!a&&(a=t.link),i.push(t.value)}),l.categories.data.push(i[0]);var r={x:f(i[1]),x2:f(i[2]),label:i[3]};d.data.push(r),d.rawData.push(r),d.links.push(a)}}),t.sheets.push(l)}),transposed:Object(r.createImportFn)(function(e,s){var o=i.a.merge({},a),c=i.a.merge({},o.series[0]);o.series=[c],c.data=[],c.rawData=[],c.links=[];var l=e[0]&&e[0].map(function(e){return Object(r.replaceBlank)(e,"",!0)})||[],u=i.a.get(t,"sheetnames[".concat(s,"]")),h=Object(r.getMaxColCount)(e);o.categories.data||(o.categories.data=[]),o.categories.title=u||Object(r.replaceBlank)(i.a.get(l,"[0]"),"",!0);for(var f=1;f<h;f++){for(var d=void 0,p=[],g=0;g<4;g++){var m=i.a.get(e,"[".concat(g,"][").concat(f,"]")),v=n(m);v.link&&!d&&(d=v.link),p.push(v.value)}o.categories.data.push(p[0]);var E={x:p[1],x2:p[2],label:p[3]};c.data.push(E),c.rawData.push(E),c.links.push(d)}t.sheets.push(o)})}}},PiB6:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return s});var n=a("LvDl"),i=a.n(n),r=a("Z8Pq");function s(e){var t=e.options,a=e.emptySheet,n=e.createNumberParser,s=Object(r.createExtractCell)(t);return{default:Object(r.createImportFn)(function(o,c){var l=i.a.merge({},a),u=o[0]||[],h=i.a.get(t,"sheetnames[".concat(c,"]")),f=n.call(e,c+1),d=i.a.merge({},l.series[0]);l.series=[d],d.data=[],d.rawData=[],d.links=[],l.categories.data=u.slice(1,5),l.categories.title=Object(r.replaceBlank)(h||u[0]);for(var p=function(e){var t=o[e];if(t.length<5)return"continue";var a=void 0,n=[];t.forEach(function(e){var t=s(e);t.link&&!a&&(a=t.link),n.push(t.value)});var i=f(n[1]),r=f(n[2]),c=f(n[3]),l=f(n[4]);if(isNaN(i)||isNaN(r)||isNaN(c)||isNaN(l))return"continue";var u=[n[0],i,r,c,l];d.data.push(u),d.rawData.push(n.slice(0)),d.links.push(a)},g=1;g<o.length;g++)p(g);t.sheets.push(l)}),transposed:Object(r.createImportFn)(function(o,c){var l=i.a.merge({},a),u=n.call(e,c+1),h=i.a.merge({},l.series[0]);l.series=[h],h.data=[],h.rawData=[],h.links=[];var f=o[0]&&o[0].map(function(e){return Object(r.replaceBlank)(e,"",!0)})||[],d=i.a.get(t,"sheetnames[".concat(c,"]")),p=Object(r.getMaxColCount)(o);l.categories.title=d||Object(r.replaceBlank)(i.a.get(f,"[0]"),"",!0),l.categories.data=[];for(var g=1;g<5;g++){var m=i.a.get(o,"[".concat(g,"][0]")),v=s(m);l.categories.data.push(v.value)}for(var E=1;E<p;E++){for(var b=void 0,O=[],_=0;_<5;_++){var T=i.a.get(o,"[".concat(_,"][").concat(E,"]")),I=s(T);I.link&&!b&&(b=I.link),O.push(I.value)}var S=u(O[1]),y=u(O[2]),A=u(O[3]),x=u(O[4]);if(!(isNaN(S)||isNaN(y)||isNaN(A)||isNaN(x))){var C=[O[0],S,y,A,x];h.data.push(C),h.rawData.push(C),h.links.push(b)}}t.sheets.push(l)})}}},S99L:function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n),r=["=","@","+"],s={convertDataToCSV:function(e,t){var a=/\"/g,n="\ufeff";return e.forEach(function(e,s){n+=e.map(function(e,n){return e&&(t||s||n)||(e=""),i.a.has(e,"value")&&(e=e.value),e=e.toString().replace(a,'""'),-1!==r.indexOf(e[0])&&(e="'".concat(e)),'"'.concat(e,'"')})+"\n"}),n},forceDownloadOfContent:function(e,t){var a=new Blob([e],{type:"octet/stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{var n=window.URL.createObjectURL(a),i=document.createElement("a");document.body.appendChild(i),i.style.display="none",i.href=n,i.download=t,i.click(),window.URL.revokeObjectURL(n),i.remove()}},downloadData:function(e){var t=e.data,a=e.title,n=e.firstCellContainsData,i="".concat(a,".csv"),r=s.convertDataToCSV(t,n);"undefined"!=typeof ga&&ga("send","event","Download chart data"),s.forceDownloadOfContent(r,i)}};t.default=s},SdvQ:function(e,t,a){"use strict";a.r(t),a.d(t,"engagementEvent",function(){return r}),a.d(t,"engagementInscreen",function(){return s});var n=a("Zcty"),i=a("LU9w"),r=function(e,t,a){n.default.dispatch({type:i.ENGAGEMENT_EVENT,objectId:e,eventType:t,action:a})},s=function(){n.default.dispatch({type:i.ENGAGEMENT_INSCREEN})}},Z8Pq:function(e,t,a){"use strict";a.r(t),a.d(t,"isBlank",function(){return r}),a.d(t,"replaceBlank",function(){return s}),a.d(t,"getMaxColCount",function(){return o}),a.d(t,"fillSheets",function(){return c}),a.d(t,"spreadSheets",function(){return u}),a.d(t,"createExtractCell",function(){return h}),a.d(t,"createImportFn",function(){return f}),a.d(t,"getRowValuesAndLink",function(){return d}),a.d(t,"categoryHelper",function(){return p}),a.d(t,"seriesHelper",function(){return g}),a.d(t,"isSeriesDataValid",function(){return m}),a.d(t,"cleanSheetSeries",function(){return v}),a.d(t,"validDataMaxLimit",function(){return E}),a.d(t,"limitSheetData",function(){return b});var n=a("LvDl"),i=a.n(n);function r(e){return"number"==typeof e&&isNaN(e)||null==e||""===e}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r(e)?t:a&&e.value?e.value:e}function o(e){return i.a.reduce(e,function(e,t){return Math.max(e,t.length)},0)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.forEach(function(e){e.length||(e=[[]]);var n=a;e.forEach(function(e){e&&e.length>n&&(n=e.length)});for(var r=Math.max(e.length,t),s=0;s<r;s++){e[s]||(e[s]=[]);for(var o=0;o<n;o++)i.a.isUndefined(e[s][o])&&(e[s][o]="")}}),e}function l(e){var t=[];return e.forEach(function(e,a){e.length<2&&0===a&&(e=[e[0]||"",""]),e.forEach(function(a,n){if(n>0){var i=n-1;(t[i]?t[i]:t[i]=[]).push([e[0],a])}})}),t}function u(e,t){if(e.length<2)return l(e[0]);if(t){var a=[];return e.forEach(function(e){l(e).forEach(function(e){a.push(e)})}),a}return e}function h(e){var t=e.custom,a="edit"!==i.a.get(t,"viewMode");return function(e){var t={};return i.a.isPlainObject(e)?(i.a.has(e,"value")&&(t.value=e.value),a&&"link"===i.a.get(e,"type")&&(t.link=e.href),t):(t.value=e,t)}}function f(e){return function(t){t.forEach(e)}}function d(e,t){var a={row:[]};return e.forEach(function(e,n){var i=t(e);i.link&&(a.link=i.link),a.row[n]=i.value}),a}function p(e){return function(t){var a=e.categories.data,n=a.indexOf(t);return-1===n&&(n=a.length,a.push(t)),n}}function g(e,t){return function(a,n){var r=e.series[a];return r||((r=e.series[a]=i.a.merge({},t)).index=void 0!==n?n:a,r.data=r.data||[],r.rawData=r.rawData||[],r.links=r.links||[]),r}}function m(e){return 0!==e.length&&i.a.some(e,function(e){return!isNaN(e)})}function v(e){var t=[];e.forEach(function(e,a){m(e.data)||t.push(a)}),function e(t,a){t.length&&(a.splice(t[0],1),t.shift(),function(e){e.forEach(function(t,a){e[a]=t-1})}(t),e(t,a))}(t,e)}function E(e,t){var a=0;return e.forEach(function(e){for(var n=e.data.length-1,i=n;i>=0;i--){var r=e.data[i];if(n=i,t(r))break}a=Math.max(a,n)}),a}function b(e,t){e.series.forEach(function(e){e.data.splice(t),e.rawData.splice(t),e.links.splice(t)}),e.categories.data.splice(t)}},ZBKM:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return c});var n=a("Zcty"),i=a("Pp7T"),r=a.n(i),s=a("JPcv"),o=a("hl5+");function c(e,t,a){r()(s.Map.isMap(t),"External chart data should be immutable"),n.default.dispatch({type:o.EDITOR_SET_CHART_EXTERNAL_DATA,id:e,data:t,model:a})}},"hl5+":function(e,t,a){"use strict";a.r(t),a.d(t,"EDITOR_STATE_CHANGE",function(){return n}),a.d(t,"EXTERNAL_EDITOR_STATE_CHANGE",function(){return i}),a.d(t,"EDITOR_SET_LOCK_ASPECT_RATIO",function(){return r}),a.d(t,"EDITOR_ADD_ENTITY",function(){return s}),a.d(t,"EDITOR_ZOOM",function(){return o}),a.d(t,"EDITOR_SCALE",function(){return c}),a.d(t,"EDITOR_SET_CHART_EXTERNAL_DATA",function(){return l}),a.d(t,"ADD_RAW_ENTITY",function(){return u}),a.d(t,"ADD_ENTITY",function(){return h}),a.d(t,"ADD_BLOCK",function(){return f}),a.d(t,"CHART_ENTITY_SET",function(){return d}),a.d(t,"SAVE_TEXT_ENTITY",function(){return p}),a.d(t,"UPDATE_TEXT_ENTITY_SIZE",function(){return g}),a.d(t,"EDITOR_STATE_UNDO",function(){return m}),a.d(t,"EDITOR_STATE_REDO",function(){return v}),a.d(t,"EDITOR_ACTION_LOADING",function(){return E}),a.d(t,"EDITOR_DISPLAY_START_SAVING",function(){return b}),a.d(t,"EDITOR_DISPLAY_STOP_SAVING",function(){return O}),a.d(t,"EXIT_GROUP_EDIT_MODE",function(){return _}),a.d(t,"ENTER_GROUP_EDIT_MODE",function(){return T}),a.d(t,"DISPLAY_MAP_POSITIONING_CONTROLS",function(){return I}),a.d(t,"SET_POSITION_FOR_ALL_SHEETS",function(){return S}),a.d(t,"RESET_MAP_POSITIONING_STATE",function(){return y}),a.d(t,"FREELAYOUT_SET_TRANSITION",function(){return A}),a.d(t,"FREE_USER_PAGE_LIMIT",function(){return x}),a.d(t,"PRO_USER_PAGE_LIMIT",function(){return C}),a.d(t,"FREELAYOUT_SET_INTERLINKED_CHARTS",function(){return k}),a.d(t,"FREELAYOUT_SET_INTERACTIVITY_HINT",function(){return N}),a.d(t,"FREELAYOUT_SET_ALLOW_TO_SHARE",function(){return w}),a.d(t,"FREELAYOUT_SET_ALLOW_FULLSCREEN",function(){return R}),a.d(t,"FREELAYOUT_SET_PROJECT_LANGUAGE",function(){return D}),a.d(t,"OPEN_EDIT_CONTEXT_MENU",function(){return P}),a.d(t,"CLOSE_EDIT_CONTEXT_MENU",function(){return L}),a.d(t,"OPEN_EDIT_CONTEXT_MENU_EXPORT_DROPDOWN",function(){return j}),a.d(t,"PAGE_RESIZE_HIDE",function(){return M}),a.d(t,"PAGE_RESIZE_HEIGHT",function(){return B}),a.d(t,"PAGE_RESIZE_LEFT",function(){return G}),a.d(t,"PAGE_RESIZE_RIGHT",function(){return U}),a.d(t,"SELECTION_STATE_CHANGE",function(){return F}),a.d(t,"SELECTION_BOUNDING_BOX_CHANGE",function(){return H}),a.d(t,"INITIAL_BOUNDING_BOX_CHANGE",function(){return Z}),a.d(t,"PUSH_BOUND_UNDO_STACK",function(){return Y}),a.d(t,"DISPLAY_IMAGE_MASKING_CONTROLS",function(){return V}),a.d(t,"DISPLAY_IMAGE_CROPPING_CONTROLS",function(){return z}),a.d(t,"START_CLIP_RESIZE",function(){return W}),a.d(t,"START_CLIP_MOVE",function(){return X}),a.d(t,"START_CLIP_ROTATE",function(){return K}),a.d(t,"TRANSFORM_IMAGE_MASK",function(){return q}),a.d(t,"MOVE_IMAGE_MASK",function(){return J}),a.d(t,"RESIZE_IMAGE_CROP",function(){return Q}),a.d(t,"MOVE_IMAGE_CROP",function(){return $}),a.d(t,"EXIT_CLIPPING_MODE",function(){return ee}),a.d(t,"APPLY_IMAGE_CLIP",function(){return te}),a.d(t,"REMOVE_IMAGE_CLIP",function(){return ae}),a.d(t,"IMAGE_MASK",function(){return ne}),a.d(t,"IMAGE_CROP",function(){return ie}),a.d(t,"COPY_ELEMENT_STYLE",function(){return re}),a.d(t,"PASTE_ELEMENT_STYLE",function(){return se});var n="EDITOR_STATE_CHANGE",i="EXTERNAL_EDITOR_STATE_CHANGE",r="EDITOR_SET_LOCK_ASPECT_RATIO",s="EDITOR_ADD_ENTITY",o="EDITOR_ZOOM",c="EDITOR_SCALE",l="EDITOR_SET_CHART_EXTERNAL_DATA",u="ADD_RAW_ENTITY",h="ADD_ENTITY",f="ADD_BLOCK",d="CHART_ENTITY_SET",p="SAVE_TEXT_ENTITY",g="UPDATE_TEXT_ENTITY_SIZE",m="EDITOR_STATE_UNDO",v="EDITOR_STATE_REDO",E="EDITOR_ACTION_LOADING",b="EDITOR_DISPLAY_START_SAVING",O="EDITOR_DISPLAY_STOP_SAVING",_="EXIT_GROUP_EDIT_MODE",T="ENTER_GROUP_EDIT_MODE",I="DISPLAY_MAP_POSITIONING_CONTROLS",S="SET_POSITION_FOR_ALL_SHEETS",y="RESET_MAP_POSITIONING_STATE",A="FREELAYOUT_SET_TRANSITION",x=5,C=10,k="FREELAYOUT_SET_INTERLINKED_CHARTS",N="FREELAYOUT_SET_INTERACTIVITY_HINT",w="FREELAYOUT_SET_ALLOW_TO_SHARE",R="FREELAYOUT_SET_ALLOW_FULLSCREEN",D="FREELAYOUT_SET_PROJECT_LANGUAGE",P="OPEN_EDIT_CONTEXT_MENU",L="CLOSE_EDIT_CONTEXT_MENU",j="OPEN_EDIT_CONTEXT_MENU_EXPORT_DROPDOWN",M="PAGE_RESIZE_HIDE",B="PAGE_RESIZE_HEIGHT",G="PAGE_RESIZE_LEFT",U="PAGE_RESIZE_RIGHT",F="SELECTION_STATE_CHANGE",H="SELECTION_BOUNDING_BOX_CHANGE",Z="INITIAL_BOUNDING_BOX_CHANGE",Y="PUSH_BOUND_UNDO_STACK",V="DISPLAY_IMAGE_MASKING_CONTROLS",z="DISPLAY_IMAGE_CROPPING_CONTROLS",W="START_CLIP_RESIZE",X="START_CLIP_MOVE",K="START_CLIP_ROTATE",q="TRANSFORM_IMAGE_MASK",J="MOVE_IMAGE_MASK",Q="RESIZE_IMAGE_CROP",$="MOVE_IMAGE_CROP",ee="RESET_CLIPPING_STORE",te="APPLY_IMAGE_CLIP",ae="REMOVE_IMAGE_CLIP",ne="IMAGE_MASK",ie="IMAGE_CROP",re="COPY_ELEMENT_STYLE",se="PASTE_ELEMENT_STYLE"},ibon:function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n),r=a("JnWj"),s=a("m6Yx"),o=a("PZzD"),c=a("PiB6"),l=a("474q"),u=a("Z8Pq"),h=a("0Qba"),f=a("Oq5T"),d=a("pWQL");function p(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.emptySheet=t.chart.emptySheetData(),this.options=t.chart.options,this.transpose=t.transpose,this.useAllColumns=t.useAllColumns,this.decimalSeparators=[].concat(t.decimalSeparator),this.disableColumnSheets=t.disableColumnSheets,this.factoryInstance=t.factoryInstance,this.chartType=t.chartType}var t,a,n;return t=e,(a=[{key:"createNumberParser",value:function(e){var t=this.decimalSeparators,a=t[e]||t[0]||".",n=".,"===a?"legacy":"firstNumber";return new r.default(n,a)}},{key:"findImportFn",value:function(t){for(var a in e.IMPORT_TYPES){var n=e.IMPORT_TYPES[a];if(-1!==n.types.indexOf(t))return this.transpose&&n.fnTranspose?n.fnTranspose:n.fn}}},{key:"import",value:function(e){if(e&&0!==e.length){var t=JSON.parse(JSON.stringify(e)),a=this.findImportFn(this.chartType);a&&(this.options.sheets=[],a.call(this,t))}}},{key:"singleSheetItem",value:function(e,t){var a=this.emptySheet,n=e.length,r=this.createNumberParser(t+1),s=Object(u.createExtractCell)(this.options);if(0!==n)for(var o=this.useAllColumns?Object(u.getMaxColCount)(e):2,c=1;c<o;c++){var l=i.a.merge({},a),h=l.series[0],f=l.categories.data=[];l.categories.title=Object(u.replaceBlank)(e[0][c]),h.data=[],h.rawData=[],h.links=[];for(var d=1;d<n;d++){var p=e[d],g="".concat(Object(u.replaceBlank)(p[0],"",!0)),m=s(p[c]);f.push(g),h.data.push(Number(r(m.value))),h.rawData.push(m.value),h.links.push(m.link)}Object(u.isSeriesDataValid)(h.data)&&this.options.sheets.push(l)}}},{key:"singleSheetItemTranspose",value:function(e,t){var a=this.emptySheet,n=e.length,r=Object(u.getMaxColCount)(e),s=this.createNumberParser(t+1);if(!(n<2))for(var o=this.useAllColumns?n:2,c=1;c<o;c++){var l=i.a.merge({},a),h=l.series[0],f=e[0].map(function(e){return Object(u.replaceBlank)(e,"",!0)}).slice(1);l.categories.title=Object(u.replaceBlank)(e[c][0]),h.data=[],h.rawData=[];var d=e[c];if(0!==d.length){for(var p=1;p<r;p++){var g=d[p];h.data.push(Number(s(g))),h.rawData.push(g)}l.categories.data=f,Object(u.isSeriesDataValid)(h.data)&&this.options.sheets.push(l)}}}},{key:"singleSheetItemOnly",value:function(e){for(var t=this.options,a=[],n=[],r=e[0]||[],s=e.length,o=this.disableColumnSheets?2:Object(u.getMaxColCount)(e),c=[],l=Object(u.createExtractCell)(t),h=1;h<s;h++){var f=e[h];a.push("".concat(Object(u.replaceBlank)(f[0],"",!0)));for(var d=1;d<o;d++){var p=d-1,g=l(f[d]),m=c[p],v=n[p];v||((v=n[p]=i.a.merge({},this.emptySheet)).categories.data=[],v.categories.title=Object(u.replaceBlank)(r[d],"",!0),v.series[0].index=p,v.series[0].data=[],v.series[0].rawData=[],v.series[0].links=[],m=c[p]=this.createNumberParser(d)),v.series[0].data.push(Number(m(g.value))),v.series[0].rawData.push(g.value),v.series[0].links.push(g.link)}}n.forEach(function(e){e.categories.data=a.slice(0)}),t.sheets=n.filter(function(e){return Object(u.isSeriesDataValid)(e.series[0].data)})}},{key:"singleSheetItemOnlyTranspose",value:function(e){for(var t=this.options,a=(e[0]&&e[0].map(function(e){return Object(u.replaceBlank)(e,"",!0)})||[]).slice(1),n=[],r=this.disableColumnSheets?2:e.length,s=Object(u.getMaxColCount)(e),o=[],c=Object(u.createExtractCell)(t),l=1;l<r;l++){var h=l-1,f=e[l],d=o[h],p=n[h];if(0!==f.length){p||((p=n[h]=i.a.merge({},this.emptySheet)).categories.title=Object(u.replaceBlank)(f[0],"",!0),p.series[0].data=[],p.series[0].rawData=[],d=o[h]=this.createNumberParser(l),p.series[0].links=[]);for(var g=1;g<s;g++){var m=c(f[g]);p.series[0].data.push(Number(d(m.value))),p.series[0].rawData.push(m.value),p.series[0].links.push(m.link)}p.categories.data=a}}t.sheets=n.filter(function(e){return Object(u.isSeriesDataValid)(e.series[0].data)})}},{key:"multiSheetItemTranspose",value:function(e,t){var a=this.options,n=this.emptySheet,r=i.a.merge({},n),s=r.series.pop(),o=e.length,c=a.sheetnames&&a.sheetnames[t],l=this.createNumberParser(t+1),h=Object(u.createExtractCell)(a),f=0;if(0!==o){var d=e[0].map(function(e){return Object(u.replaceBlank)(e,"",!0)});r.categories.title=Object(u.replaceBlank)(c||d[0]),r.categories.data=d.slice(1);for(var p=1;p<o;p++){var g=e[p],m=g.length;if(m){var v=h(g[0]),E=i.a.merge({},s,{title:"".concat(Object(u.replaceBlank)(v.value,"",!0)),index:p-1,data:[],rawData:[],links:[],titleLink:v.link});f=Math.max(f,m-1),E.titleLink=v.link;for(var b=1;b<m;b++){var O=h(g[b]);E.data.push(Number(l(O.value))),E.rawData.push(O.value),E.links.push(O.link)}Object(u.isSeriesDataValid)(E.data)&&r.series.push(E)}}for(var _=0;_<f;_++)r.categories.data[_]=Object(u.replaceBlank)(r.categories.data[_]);a.sheets.push(r)}else a.sheets.push(i.a.merge(r,{categories:{title:"",data:[]},series:[i.a.merge(s,{data:[],rawData:[]})]}))}},{key:"multiSheetItem",value:function(e,t){var a=this.options,n=i.a.merge({},this.emptySheet),r=n.series.pop(),s=e.length,o=a.sheetnames&&a.sheetnames[t],c=this.createNumberParser(t+1),l=Object(u.createExtractCell)(a);if(0!==s){var h=Object(u.getMaxColCount)(e),f=e[0].map(function(e){return Object(u.replaceBlank)(e,"")}),d=l(f.shift()).value,p=[],g=[];f.forEach(function(e,t){var a=l(e);p[t]=a.link,g[t]=a.value});var m=function(e,t){var a;(a=n.series[e]?n.series[e]:n.series[e]=i.a.merge({},r,{title:"".concat(Object(u.replaceBlank)(g[e])),data:[],index:e,rawData:[],links:[]})).links.push(t.link),a.data.push(Number(c(t.value))),a.rawData.push(t.value),a.titleLink=p[e]};n.categories.title=Object(u.replaceBlank)(o||d),n.categories.data=[];for(var v=1;v<s;v++){var E=e[v],b=E.length,O=Object(u.replaceBlank)(E[0],"");if(i.a.has(O,"value")&&(O=O.value),b){n.categories.data.push(O);for(var _=1;_<h;_++)m(_-1,l(E[_]))}}Object(u.cleanSheetSeries)(n.series),a.sheets.push(n)}else a.sheets.push(i.a.merge(n,{categories:{title:"",data:[]},series:[i.a.merge(r,{data:[],rawData:[]})]}))}},{key:"doubleAxisSheetItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,r=n.sheetnames&&n.sheetnames[t],s=this.createNumberParser(t+1),o=Object(u.createExtractCell)(n);a.series[0].data||(a.series[0].data=[]),a.series[0].rawData||(a.series[0].rawData=[]),a.series[0].links||(a.series[0].links=[]),a.series[1].links||(a.series[1].links=[]),a.series[1].data||(a.series[1].data=[]),a.series[1].rawData||(a.series[1].rawData=[]),a.categories.data||(a.categories.data=[]),a.series[1].links||(a.series[1].links=[]),e.forEach(function(e,t){if(0===t)a.categories.title=Object(u.replaceBlank)(r||e[0]),a.axis[1].title=Object(u.replaceBlank)(e[1],"",!0),a.axis[2].title=Object(u.replaceBlank)(e[2],"",!0),a.axis[1].ticks=a.axis[2].ticks=!0,a.series[0].title=Object(u.replaceBlank)(e[1],"",!0),a.series[1].title=Object(u.replaceBlank)(e[2],"",!0);else{var n=Object(u.replaceBlank)(e[0],"",!0);if(Object(u.isBlank)(n))return;for(var i=[],c=1;c<3;c++){var l=o(e[c]);l.link&&(i[c-1]=l.link),e[c]=l.value}a.categories.data.push("".concat(n)),a.series[0].data.push(Number(s(e[1]))),a.series[0].rawData.push(e[1]),a.series[1].data.push(Number(s(e[2]))),a.series[1].rawData.push(e[2]),a.series[0].index=0,a.series[1].index=1,a.series[0].links.push(i[0]),a.series[1].links.push(i[1])}}),this.options.sheets.push(a)}},{key:"doubleAxisSheetItemTranspose",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=e[0]&&e[0].map(function(e){return Object(u.replaceBlank)(e,"",!0)})||[],r=Object(u.getMaxColCount)(e),s=this.options,o=s.sheetnames&&s.sheetnames[t],c=this.createNumberParser(t+1),l=Object(u.createExtractCell)(s);a.series[0].data||(a.series[0].data=[]),a.series[0].rawData||(a.series[0].rawData=[]),a.series[0].links||(a.series[0].links=[]),a.series[1].links||(a.series[1].links=[]),a.series[1].data||(a.series[1].data=[]),a.series[1].rawData||(a.series[1].rawData=[]),a.categories.data||(a.categories.data=[]),a.categories.data=n.slice(1),a.categories.title=Object(u.replaceBlank)(o||n[0]),a.axis[1].ticks=a.axis[2].ticks=!0;for(var h=0;h<2;h++){var f=e[h+1];a.axis[h+1].title=Object(u.replaceBlank)(f[0],"",!0),a.series[h].title=Object(u.replaceBlank)(f[0],"",!0),a.series[h].index=h;for(var d=1;d<r;d++){var p=l(f[d]);a.series[h].links.push(p.link),a.series[h].data.push(Number(c(p.value))),a.series[h].rawData.push(p.value)}}this.options.sheets.push(a)}},{key:"comboSheetItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,r=i.a.merge({},a.series[0]),s=e[0]||[],o=n.sheetnames&&n.sheetnames[t],c=this.createNumberParser(t+1),l=Object(u.getMaxColCount)(e),h=Object(u.createExtractCell)(n);a.series=[],a.categories.data||(a.categories.data=[]);var f=Object(u.seriesHelper)(a,r);s&&(a.categories.title=Object(u.replaceBlank)(o||h(s[0]).value));var d=i.a.get(this.options,"sheetOptions[".concat(t+1,"].axis[2]"));d&&!0===d.ticks&&l<3&&(this.options.sheetOptions[t+1].series[0].axisIndex=1,this.options.sheetOptions[t+1].axis[2].ticks=!1),e.forEach(function(e,t){if(0!==t){a.categories.data.push(Object(u.replaceBlank)(h(e[0]).value));for(var n=1;n<l;n++){var i=h(e[n]),r=i.value,o=i.link,d=f(n-1);if(1===t&&!d.title&&s[n]){var p=h(s[n]),g=p.value,m=p.link;d.title=Object(u.replaceBlank)(g),d.titleLink=m}d.data.push(Number(c(r))),d.rawData.push(r),d.links.push(o)}}});var p=Object(u.validDataMaxLimit)(a.series,function(e){return!isNaN(e)});p=Math.max(p,Object(u.validDataMaxLimit)([a.categories],function(e){return!Object(u.isBlank)(e)}))+1,Object(u.limitSheetData)(a,p),Object(u.cleanSheetSeries)(a.series),this.options.sheets.push(a)}},{key:"FactsAndFiguresItem",value:function(e,t){var a=this.options,n=i.a.merge({},this.emptySheet),r=e.length,s=a.sheetnames&&a.sheetnames[t]||"Sheet ".concat(t+1);0!==r?(n.categories.data=[],n.categories.title=Object(u.replaceBlank)(s),e.forEach(function(e){if(e.length){var t=h.default.shapes[e[2]];n.categories.data.push({color:e[4],figure:e[0],fact:e[1],shape:t})}}),a.sheets.push(n)):a.sheets.push(i.a.merge(n,{categories:{title:"",data:[]}}))}},{key:"comboSheetItemTranspose",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=i.a.merge({},a.series[0]),r=this.options,s=e[0]||[],o=r.sheetnames&&r.sheetnames[t],c=this.createNumberParser(t+1),l=Object(u.getMaxColCount)(e),h=Object(u.createExtractCell)(r);a.series=[],a.categories.data||(a.categories.data=s.slice(1).map(function(e){return h(e).value}));var f=Object(u.seriesHelper)(a,n);s&&(a.categories.title=Object(u.replaceBlank)(o||h(s[0]).value));var d=i.a.get(this.options,"sheetOptions[".concat(t+1,"].axis[2]"));d&&!0===d.ticks&&e.length<3&&(this.options.sheetOptions[t+1].series[0].axisIndex=1,this.options.sheetOptions[t+1].axis[2].ticks=!1),e.forEach(function(e,t){if(0!==t){var a=f(t-1),n=h(e[0]),i=n.value,r=n.link;a.title=Object(u.replaceBlank)(i),a.titleLink=r;for(var s=1;s<l;s++){var o=h(e[s]),d=o.value,p=o.link;a.data.push(Number(c(d))),a.rawData.push(d),a.links.push(p)}}});var p=Object(u.validDataMaxLimit)(a.series,function(e){return!isNaN(e)});p=Math.max(p,Object(u.validDataMaxLimit)([a.categories],function(e){return!Object(u.isBlank)(e)}))+1;var g=a.categories.data.length;if(g<p)for(var m=g;m<p;m++)i.a.isUndefined(a.categories.data[m])&&(a.categories.data[m]="");Object(u.limitSheetData)(a,p),Object(u.cleanSheetSeries)(a.series),this.options.sheets.push(a)}},{key:"scatterSheetItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,r=i.a.merge({},a.series[0]),s=e[0]||[],o=n.sheetnames&&n.sheetnames[t],c=this.createNumberParser(t+1),l=Object(u.createExtractCell)(n),h=3===Object(u.getMaxColCount)(e);a.series=[],a.categories.data||(a.categories.data=[]);var f=Object(u.seriesHelper)(a,r),d=Object(u.categoryHelper)(a);s&&(a.categories.title=Object(u.replaceBlank)(o||s[0]),a.categories.valueLabel=Object(u.replaceBlank)(s[3],"",!0),a.axis[0].valueLabel=Object(u.replaceBlank)(s[1],"",!0),a.axis[1].valueLabel=Object(u.replaceBlank)(s[2],"",!0));var p=h?function(e,t){if(0!==t){var n=Object(u.getRowValuesAndLink)(e,l),i=n.row,r=n.link,s=i[1],o=i[2];if(!Object(u.isBlank)(s)&&!Object(u.isBlank)(o)){var h=i[0],d=a.categories.data.length;a.categories.data.push(h);var p=f(d,t-1),g=[Number(c(s)),Number(c(o))],m=[s,o];p.data.push(g),p.rawData.push(m),p.links.push(r)}}}:function(e,t){if(0!==t){var a=Object(u.getRowValuesAndLink)(e,l),n=a.row,i=a.link,r=n[1],s=n[2];if(!Object(u.isBlank)(r)&&!Object(u.isBlank)(s)){var o=n[4]?4:0,h=4===o?0:4,p=n[o],g=n[h],m=n[3],v=d(p),E=f(v,t-1),b=[Number(c(r)),Number(c(s))],O=[r,s];null!=m&&(O[2]=m,b[2]=Number(c(m))),null!=g&&(O[3]=g),E.data.push(b),E.rawData.push(O),E.links.push(i)}}};e.forEach(p),this.options.sheets.push(a)}},{key:"scatterSheetItemTranspose",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=i.a.merge({},a.series[0]),r=Object(u.getMaxColCount)(e),s=this.options,o=e[0]&&e[0].map(function(e){return Object(u.replaceBlank)(e,"",!0)})||[],c=Object(u.categoryHelper)(a),l=Object(u.seriesHelper)(a,n),h=o,f=e[1],d=e[2],p=e[3],g=e[4],m=i.a.get(s,"sheetnames[".concat(t,"]")),v=this.createNumberParser(t+1),E=Object(u.createExtractCell)(s);a.series=[],a.categories.data||(a.categories.data=[]),a.categories.title=m||Object(u.replaceBlank)(i.a.get(o,"[0]"),"",!0),a.categories.valueLabel=Object(u.replaceBlank)(i.a.get(e,"[3][0]"),"",!0),a.axis[0].valueLabel=Object(u.replaceBlank)(i.a.get(e,"[1][0]"),"",!0),a.axis[1].valueLabel=Object(u.replaceBlank)(i.a.get(e,"[2][0]"),"",!0);for(var b=1;b<r;b++){var O=g?h:g,_=E((g||h)[b]),T=E(O,"[".concat(b,"]")).value,I=E(f[b]),S=E(d[b]),y=I.value,A=S.value,x=E(i.a.get(p,"[".concat(b,"]"))),C=x.value,k=l(c(_.value)),N=[Number(v(y)),Number(v(A))],w=[y,A],R=void 0;null!=C&&(w[2]=C,N[2]=Number(v(C))),null!=T&&(w[3]=T),[E(h),I,S,x,E(g)].forEach(function(e){e.link&&(R=e.link)}),k.data.push(N),k.rawData.push(w),k.links.push(R)}this.options.sheets.push(a)}},{key:"timerSheetItem",value:function(e){var t=e[0],a=!t[14]||"1"===t[14],n=this.options.sheets.push({value:new Date("".concat([t[2],t[3],t[1]].join("/")," ").concat(t.slice(4,7).join(":"))),valueString:t[0],units:t.slice(8,14),mode:t[7],categories:{title:!!a&&t[0]}});this.options.sheets[n-1].id=n.toString()}},{key:"sheetIterator",value:function(e,t){e.forEach(t,this)}},{key:"tableItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,r=i.a.get(n,"sheetOptions[0]",{}),s=i.a.get(n,"sheetOptions[".concat(t+1,"]"),{}),o=r.hasHeaderRow,c=r.hasHeaderColumn,l=r.usePathInsteadOfText,d=i.a.get(s,"mergeCells",[]),p=i.a.get(s,"style.defaultPath")||i.a.get(r,"style.defaultPath"),g=l&&p,m=n.sheetnames&&n.sheetnames[t];a.series={data:[],shapes:h.default.shapes,sort:null};var v=0;e.forEach(function(e){v=Math.max(v,e.length)}),e.forEach(function(e,t){a.series.data[t]=[];for(var n=0;n<v;n++){var i=!t&&o||!n&&c?"igc-table-header":"igc-table-cell";a.series.data[t][n]=Object(f.default)(e[n],i,n&&g)}}),d.forEach(function(e){var t=e.col,n=e.rowspan,r=e.colspan,s=e.row,o=a.series.data;if(i.a.has(a,"series.data[".concat(s,"][").concat(t,"]"))){if(o[s][t].colspan=r,o[s][t].rowspan=n,r>1)for(var c=1;c<r;c++)o[s][t+c]&&(o[s][t+c].remove=!0);for(var l=s+1;l<s+n;l++)for(var u=0;u<r;u++)o[l]&&(o[l][t+u].remove=!0)}});var E=[];a.series.data.forEach(function(e){var t=[];e.forEach(function(e){e.remove||t.push(e)}),E.push(t)}),a.series.data=E,a.categories.title=Object(u.replaceBlank)(m)||i.a.get(E,"[0][0].value")||"Sheet "+t,o&&(a.series.headerRow=a.series.data.shift()),this.options.sheets.push(a)}},{key:"mapItem",value:function(e,t){var a=i.a.merge({},this.emptySheet),n=this.options,r=n.sheetnames&&n.sheetnames[t],s=Object(u.createExtractCell)(n),o=t+1,c=this.createNumberParser(o),l=/([^0-9]*)[0-9\.\ \,\']+([^0-9]*)/g,h=!!i.a.get(n,"sheetOptions[".concat(o,"].points"));a.series={data:{}},a.categories.title=Object(u.replaceBlank)(r)||"Sheet "+t;var f=i.a.get(n,"sheetOptions[".concat(o,"].xmin")),d=i.a.get(n,"sheetOptions[".concat(o,"].xmax")),p=i.a.get(n,"sheetOptions[0].xmin"),g=i.a.get(n,"sheetOptions[0].xmax"),m=[];if(void 0!==f&&void 0!==d&&""!==f&&""!==d)m=[f,d];else if(void 0!==p&&void 0!==g&&""!==g&&""!==p)m=[p,g];else{var v=!1;e.forEach(function(e){var t=Number(c(e[1]&&e[1].type?e[1].value:e[1]));!v&&Number.isFinite(t)?(m=[t,t],v=!0):Number.isFinite(t)&&(m[0]=Math.min(m[0],t),m[1]=Math.max(m[1],t))}),v||(m=[0,10]),m[1]===m[0]&&m[0]--,m[0]>0&&(m[0]=0)}a.limits=m;var E="",b="",O=/([\-]?[0-9]+[\.]?[0-9]*)[ \,]+([\-]?[0-9]+[\.]?[0-9]*)/;e.forEach(function(e,t){var n,r=i.a.map(e,function(e){var t=(e=s(e)).value;return e.link&&(n=e.link),t});r[0]=r[0]&&r[0].toString().trim()||"",r[2]=r[2]&&r[2].toString().trim()||"";var o=r[1]?r[1].toString():"";if(0===t){l.lastIndex=0;var u=l.exec(o);u&&(E=u[1],b=u[2])}else E&&0!==o.indexOf(E)&&(E=""),b&&o.indexOf(b)!==o.length-b.length&&(b="");var f=Number(c(r[1]||0)),d=m[1]!==m[0]?(f-m[0])/(m[1]-m[0]):1;!isFinite(d)||d<0?d=0:d>1&&(d=1);var p="",g={lat:null,lng:null};if(r[3]){O.lastIndex=0;var v=O.exec(r[3]);v&&v.length>2&&(g=[parseFloat(v[1])||0,parseFloat(v[2])||0])}r.length>5&&(p=r.slice(5).join("\n"));var _=h?"".concat(r[3]).concat(r[1]):r[0];a.series.data[_]={title:r[0],value:i.a.has(r[1],"value")?r[1].value:r[1],group:i.a.has(r[2],"value")?r[2].value:r[2],coordinates:g,label:(i.a.has(r[4],"value")?r[4].value:r[4])||r[0],text:p,link:n,valueNumber:f,relativeValue:d}}),"-"===E&&(E=""),a.categories.prefix=E,a.categories.suffix=b,this.options.sheets.push(a)}}])&&p(t.prototype,a),n&&p(t,n),e}();g.IMPORT_TYPES={singleSheet:{types:[d.BAR,d.BAR_PROGRESS,d.COLUMN,d.WATERFALL,d.PIE,d.PIE_IRREGULAR,d.DOUGHNUT,d.SEMI_CIRCLE,d.BAR_RADIAL,d.PICTORIAL_SIZE,d.PICTORIAL_GRID,d.PICTORIAL_BAR,d.TREEMAP,d.WORDCLOUD,d.PYRAMID,d.FUNNEL],fn:function(e){e.length>1?this.sheetIterator(e,function(e,t){this.singleSheetItem(e,t)}):this.singleSheetItemOnly(e[0])},fnTranspose:function(e){e.length>1?this.sheetIterator(e,function(e,t){this.singleSheetItemTranspose(e,t)}):this.singleSheetItemOnlyTranspose(e[0])}},multiSheet:{types:[d.LINE,d.DOT_PLOT,d.AREA,d.AREA_STACKED,d.AREA_STACKED_PERCENT,d.AREA_STEPPED,d.STREAM_GRAPH,d.COLUMN_GROUPED,d.COLUMN_STACKED,d.COLUMN_STACKED_PERCENT,d.BAR_GROUPED,d.BAR_STACKED,d.BAR_STACKED_PERCENT],fn:function(e){this.sheetIterator(e,function(e,t){this.multiSheetItem(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.multiSheetItemTranspose(e,t)})}},bubblePlot:{types:[d.BUBBLE_PLOT],fn:function(e){this.sheetIterator(e,function(e,t){this.multiSheetItemTranspose(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.multiSheetItem(e,t)})}},doubleAxis:{types:[d.COLUMN_LINE,d.LINE_LINE],fn:function(e){this.sheetIterator(e,function(e,t){this.doubleAxisSheetItem(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.doubleAxisSheetItemTranspose(e,t)})}},combo:{types:[d.COMBO_GROUPED,d.COMBO_STACKED],fn:function(e){this.sheetIterator(e,function(e,t){this.comboSheetItem(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.comboSheetItemTranspose(e,t)})}},lineErrorMargin:{types:[d.LINE_ERROR_MARGIN],fn:function(e){Object(l.default)(this).default(e)},fnTranspose:function(e){Object(l.default)(this).transposed(e)}},timer:{types:[d.TIMER],fn:function(e){this.sheetIterator(e,this.timerSheetItem)}},scatter:{types:[d.SCATTER,d.SCATTER_GROUPED,d.BUBBLE],fn:function(e){this.sheetIterator(e,function(e,t){this.scatterSheetItem(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.scatterSheetItemTranspose(e,t)})}},gantt:{types:[d.GANTT],fn:function(e){Object(o.default)(this).default(e)},fnTranspose:function(e){Object(o.default)(this).transposed(e)}},map:{types:[d.MAP],fn:function(e){this.sheetIterator(e,function(e,t){this.mapItem(e,t)})}},table:{types:[d.TABLE],fn:function(e){this.sheetIterator(e,function(e,t){this.tableItem(e,t)})}},FactsAndFigures:{types:[d.FACTS_AND_FIGURES],fn:function(e){var t=this;this.sheetIterator(e,function(e,a){t.FactsAndFiguresItem(e,a)})}},gauge:{types:[d.GAUGE],fn:function(e){Object(s.default)(e,this)}},candle:{types:[d.CANDLESTICK],fn:function(e){Object(c.default)(this).default(e)},fnTranspose:function(e){Object(c.default)(this).transposed(e)}}},t.default={create:function(e){return new g(e)},NumberParser:r.default}},m6Yx:function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n),r=a("Z8Pq");t.default=function(e,t){var a=t.emptySheet,n=t.createNumberParser,s=t.options,o=t.useAllColumns,c=s.sheets,l=s.custom;function u(e,s){var o=n.call(t,s+1),u=function(e,t){return e=o(e),isNaN(e)?t:e},h=i.a.merge({},a),f=h.series[0],d=h.categories.data=[];h.categories.title=Object(r.replaceBlank)(e[0][1],"");var p=Object(r.replaceBlank)(e[1][1],0),g=u(p,0),m=Object(r.replaceBlank)(e[2][1],100),v=u(m,100),E=e[3][1],b=E&&"link"===E.type,O=Object(r.replaceBlank)(b?E.value:E,50),_=u(O,50),T=Object(r.replaceBlank)(e[4][1],"");d.push(T);var I={min:{label:p.toString(),value:g},max:{label:m.toString(),value:v},value:_};b&&"edit"!==i.a.get(l,"viewMode")&&(I.link=E.href),f.index=s,f.data.push(I),f.rawData.push(i.a.merge({},I,{value:O})),c.push(h)}e=Object(r.fillSheets)(e,5,2),e=Object(r.spreadSheets)(e,o),void 0===t.sheetIndex?e.forEach(function(e,t){u.call(this,e,t)},this):u.call(this,e[t.sheetIndex],t.sheetIndex)}},pLmG:function(e,t,a){"use strict";a.r(t),function(e,n){var i=a("Du7+"),r=function(e){return parseInt(e.ord,10)};var s=function(e,t,a){var n=e.position()[a]-t.position()[a];return n=(n>0?"+=":"-=")+Math.abs(n)+"px"};t.default={recalculateMargin:function(){var t=i.default.getMargin(),a=!1;e(".moveable_w, .undo_w").each(function(){var n=e(this).hasClass("shrink"),i=0;a&&n&&(i=t-1),i<0&&(i=0),e(this).css("margin-left",i),a=n&&!a})},removeMargin:function(t){e(t).css("margin-left","")},setPlaceholders:function(){var t,a,n,r,o,c=e(".ig-items").width(),l=[];return e(".sbs_placeholder").remove(),e(".moveable_w.shrink").each(function(){var u=e(this).width();t=!!e(this).next(".moveable_w.shrink, .undo_w.shrink").length,n=e(this).position().left+u,a=c-n,!t&&a>u&&((r=e('<div class="sbs_placeholder">')).html('<div class="sbs_placeholder_message">'),r.find(".sbs_placeholder_message").html('<p class="center_vh">'+i18n.t("app.edit.drag_here")+"</p>"),o=e(this).children(".moveable"),r.css("width",o.width()),r.height(o.height()),e(this).after(r),l.push(r.get(0)),r.on("drop",function(t){var a=t.originalEvent.dataTransfer,n=a.getData("text");if(n){var r,o=e('[data-object-id="'+n+'"]'),c=e(this),l=c.prev(),u=parseInt(o.attr("ord"),10),h=parseInt(l.attr("ord"),10),f=h+1,d=o.find(".icon-min-object");if(u<h&&(f=h),!o.is(l)){if(r=o.clone(),c.remove(),!o.hasClass("shrink")){var p=r.find(".moveable").hasClass("chart");if(p){var g=e(this).width()-i.default.getMargin();r.find(".inner").width(g)}d.trigger("click"),ga("send","event","edit","side_by_side","drag_and_drop",0),ga("App.send","event","edit","side_by_side","drag_and_drop",0)}e.ajax({url:"/api/itemorder/".concat(graphicID),headers:{"csrf-token":window.app.profile.csrfToken},data:{newpos:f,count:e(".moveable_w").length,type:o.attr("data-object-type"),object_id:o.attr("data-object-id")},type:"PUT",beforeSend:function(){window.app.events.trigger("Editable:saving")}}).done(function(){r.find(".moveable").css({"margin-left":"20px"}),r.css({position:"absolute",width:o.css("width"),"z-index":10,"margin-left":0,"margin-right":0,top:o.position().top+"px",left:o.position().left+"px"}).insertBefore(o),o.css("opacity",0),o.insertAfter(l);var t=s(o,r,"top"),a=s(o,r,"left");r.animate({top:t,left:a},{complete:function(){e(".item-insertion").remove(),r.remove(),o.css("opacity",1),window.app.events.trigger("Editable:resetOrder Editable:shrink")}})}).fail(function(){window.app.message.error(i18n.t("app.errors.order_state"))}).always(function(){window.app.events.trigger("Editable:saved")})}}}))}),l},lastInRowElements:function(){var t=[],a=[];e(".moveable_w.shrink").each(function(){a.push({id:e(this).attr("data-object-id"),top:e(this).position().top,ord:e(this).attr("ord")})});var i=n.groupBy(a,function(e){return e.top});for(var s in i)t.push(n.maxBy(i[s],r));return t},chartWidth:function(t){var a=e(".ig-items").width();return parseInt((a-2*i.default.getChartPadding()-i.default.getMargin())/t,10)},boxWidth:function(t,a){var n=e(".ig-items").width(),r=parseInt((n-i.default.getMargin())/2,10);a.css({width:r+"px"})}}}.call(this,a("+hRF"),a("LvDl"))},tcv8:function(e,t,a){"use strict";a.r(t);var n=a("LvDl"),i=a.n(n);function r(e,t){if(i.a.isEqual(t,[]))return t}t.default=function(e){var t=e.chart,a=e.sheetIndex,n=void 0===a,s=t.get("sheets_settings"),o=s[a];function c(){return t.get("colors")}return{get isCommon(){return n},getColors:function(){return n?c():o&&i.a.has(o,"colors")&&o.colors&&o.colors.length?o.colors:c()},getCustomValue:function(e,a){var r=this.getCustom();return i.a.has(r,e)?i.a.get(r,e):!n&&(r=t.get("custom"),i.a.has(r,e))?i.a.get(r,e):a},getCustom:function(){return o||t.get("custom")},getLocalisations:function(){return i.a.get(t.get("custom"),"map_json.localisations")},getCustomStrict:function(){return n?t.get("custom"):o||{}},setCustom:function(e){if(n){var c=t.get("custom");i.a.mergeWith(c,e,r)}else o||(o=s[a]={}),i.a.mergeWith(o,e,r),t.set("sheets_settings",s,{silent:!0})},removeCustom:function(e){if(n){var r=t.get("custom");e.forEach(function(e){i.a.unset(r,e)})}else o||(o=s[a]={}),e.forEach(function(e){i.a.unset(o,e)}),t.set("sheets_settings",s,{silent:!0})}}}},wUcv:function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"buildXHR",function(){return r});var n=a("LvDl"),i=a.n(n);function r(t){var a,n=t.chart,r=t.sheetIndex,s=t.applyToAllSheets,o={infographic:n.get("block_id"),applyToAllSheets:s};return void 0!==r?(o.sheet_settings_index=r,a=o.sheet_settings={}):a=o.custom={},{searchOsm:function(t,a){return e.ajax({url:encodeURI("https://nominatim.openstreetmap.org/search/?format=json&accept-language=en-GB,en-US&limit=1&bounded=1&q=".concat(t,"&viewbox=").concat(a[0][1],",").concat(a[0][0],",").concat(a[1][1],",").concat(a[1][0])),type:"GET",format:"json"})},send:function(){return i.a.has(o,"custom.groupedColors")&&(o.custom.groupedColors=i.a.toPairs(o.custom.groupedColors)),n.get("isFreelayoutInline")?e.Deferred().resolve():e.ajax({url:"/api/charts/"+n.get("object_id"),type:"PUT",data:JSON.stringify(o),contentType:"application/json; charset=utf-8",headers:{"csrf-token":window.app.profile.csrfToken}})},setCustom:function(e){return i.a.merge(a,e),this},setParams:function(e){return i.a.merge(o,e),this}}}}.call(this,a("+hRF"))},wrGL:function(e,t,a){"use strict";a.r(t),a.d(t,"defaultColorValue",function(){return s}),a.d(t,"defaultColorMethod",function(){return o}),a.d(t,"gridColor",function(){return c});var n=a("LvDl"),i=a.n(n),r=a("pWQL");function s(e,t){var a={method:"contrast",contrast:{dark:e||"#000000",light:"#ffffff"},manual:{fill:"#000000",stroke:"#ffffff"}};return"manual"===t&&(i.a.set(a,"method",t),i.a.set(a,"contrast.dark","#000000"),i.a.set(a,"manual.fill",e||"#000000")),a}function o(e){return-1!==[r.WATERFALL,r.GANTT].indexOf(e.getTypeMod())?"manual":"contrast"}function c(e,t){return i.a.get(e,"axis.color")||i.a.get(t,"charts.grid.color")||i.a.get(e,"textColor")||i.a.get(t,"color.chart.text")||i.a.get(t,"color.text")}}}]);